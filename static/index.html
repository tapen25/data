<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡Œå‹•èªè­˜</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center h-screen">
  <h1 class="text-2xl font-bold mb-4">ğŸ“± ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡Œå‹•èªè­˜</h1>
  <div id="status" class="text-lg text-blue-700 font-semibold mb-2">ã‚»ãƒ³ã‚µå–å¾—å¾…æ©Ÿä¸­...</div>
  <div id="result" class="text-3xl font-bold text-green-600">---</div>

  <script>
    let accX = [], accY = [], accZ = [];

    async function sendData() {
      if (accX.length < 20) return; // ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒæºœã¾ã£ã¦ã‹ã‚‰é€ä¿¡

      const payload = { AccX: accX, AccY: accY, AccZ: accZ };
      accX = []; accY = []; accZ = [];

      const res = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
      const data = await res.json();
      document.getElementById("result").textContent = "è¡Œå‹•çŠ¶æ…‹: " + data.prediction;
    }

    if (window.DeviceMotionEvent) {
      document.getElementById("status").textContent = "ğŸ“² ã‚¹ãƒãƒ›ã‚’å‹•ã‹ã—ã¦ãã ã•ã„ï¼";
      window.addEventListener("devicemotion", (event) => {
        accX.push(event.acceleration.x || 0);
        accY.push(event.acceleration.y || 0);
        accZ.push(event.acceleration.z || 0);
      });
      setInterval(sendData, 1000); // 1ç§’ã”ã¨ã«é€ä¿¡
    } else {
      document.getElementById("status").textContent = "âŒ ã“ã®ãƒ‡ãƒã‚¤ã‚¹ã¯åŠ é€Ÿåº¦ã‚»ãƒ³ã‚µã«éå¯¾å¿œã§ã™ã€‚";
    }
  </script>
</body>
</html>
